# v0.5.1发布日志

> 发布日志：2022-04-23



## 1 体系性、扩展性

v0.5.1版本在保持整体公共访问接口不变的基础上，进一步重构底层实现逻辑。目前按照代码包可划分为以下模块：

| 代码包/模块                 | 描述               |      |
| --------------------------- | ------------------ | ---- |
| django_echarts.contrib      | 内置的主题APP      |      |
| django_echarts.core         | 依赖项、主题配置   |      |
| django_echarts.entities     | 组件定义层         |      |
| django_echarts.management   | 命令行工具         |      |
| django_echarts.renders      | 组件、依赖项渲染层 |      |
| django_echarts.starter      | 网站视图路由层     |      |
| django_echarts.stores       | 组件存储层         |      |
| django_echarts.templates    | 模板文件           |      |
| django_echarts.templatetags | 标签函数           |      |
| django_echarts.conf         | 配置访问层         |      |
| django_echarts.geojson      | geojson工具层      |      |
| django_echarts.views        | 普通视图层         |      |

主要变化

- `DJESite` 中组件存储相关功能独立为 `renders`模块。

之前 `DJESite.resolve_chart` 改为 `EntityFactory.get_chart_and_info`

## 2 组件体系

进一步抽象组件的共有特性，比如是否包括依赖项、是否是容器组件等。新增诸如 `ContainerBase` 、`HTMLWidgetBase` 等组件基类封装共同逻辑。

支持容器组件的嵌套使用。

在实现上使用 [singledispatch](https://docs.python.org/3/library/functools.html#functools.singledispatch) 的函数重载功能，这样：

- 所有组件拥有同一的入口，如使用`dw_widget` 标签可渲染所有类型的组件
- 将参数和变量的类型明确化，减少了 Duck Type 代码的使用。

## 3 其他更新

- `WidgetGetterMixin` 接口方法 `resolve_*` 重命名为 `get_*` 
- `DJESite` 不再实现 `WidgetGetterMixin`

